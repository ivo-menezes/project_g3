@startuml
!theme plain
hide footbox
autonumber
title "US017 - As Product Owner, I want to create a user story and add it to the Product Backlog"

actor "Product Owner" as user
participant ":CreateUserStoryUI" as UI
participant "userStoryDTO :UserStoryDTO" as dto
participant ":CreateUserStoryController" as Controller
participant ":UserStoryService" as Services
participant ":ProjectRepository" as Repository
participant "factoryUserStory :FactoryUserStoryImpl" as Factory
participant "userStory :UserStory" as UserStory
participant "userStoryRepository :UserStoryRepository" as UsRepository
participant ":Project" as Project

activate user #FFBBBB
user ->  UI: Selects project and inserts US data\n (projectCode, userStoryId, actor, \ntext, acceptanceCriteria, priority)

activate UI #FFBBBB
UI --> dto ** : create(userStoryId, actor, \ntext, acceptanceCriteria)
UI -> Controller: createUserStory(projectCode, \nuserStoryDTO, priority)

activate Controller #FFBBBB
Controller -> Services: createUserStory (projectCode,\n userStoryDTO, priority)

activate Services #FFBBBB
Services -> Repository: containsID(projectCode)

activate Repository #FFBBBB
Repository -->Services: true
deactivate
Services -> Factory:createUserStory\n (userStoryDTO)

activate Factory #FFBBBB
Factory --> "userStoryID:UserStoryID" ** :create (userStoryDTO.userStoryID)
Factory --> "userStoryActor:UserStoryActor" ** :create (userStoryDTO.actor)
Factory --> "userStoryAcceptanceCriteria:UserStoryAcceptanceCriteria" ** :create (userStoryDTO.acceptanceCriteria)
Factory --> "description:Description" ** :create (userStoryDTO.description)
Factory --> UserStory ** :create (userStoryID,\n userStoryActor,\n userStoryStatus,\n userStoryAcceptanceCriteria,\n description )
Factory --> Services :userStory
deactivate
Services -> UsRepository :save(userStory)


activate UsRepository #FFBBBB
UsRepository ->UsRepository :containsID(userStoryID)
UsRepository ->UsRepository :put(userStoryID, userStory)
UsRepository --> Services: true
deactivate
Services -> Project :addToSet(userStoryID, priority)
activate Project #FFBBBB
Project --> Services: true
deactivate
Services --> Controller: true
deactivate
Controller --> UI: true
deactivate
UI --> user: Confirms US creation and addition to Product Backlog.

@enduml